# Cтарт приложения

- Cоздание и применений миграций:

  alembic revision --autogenerate -m "adding tables"

  alembic upgrade head

- Установка зависимостей:
  pip install -r requirements.txt

- Запуск приложения:
  uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload




# Файл .env
- База данных PostgreSQL

POSTGRES__USER
POSTGRES__PASSWORD
POSTGRES__HOST
POSTGRES__PORT
POSTGRES__DB
-JWT Настройки


JWT__SECRET
JWT__ALGORITHM



# Документация

После запуска приложения документация доступна по адресам:

Swagger UI: http://127.0.0.1:8000/api/v1/docs#/

ReDoc: http://localhost:8000/redoc

# Структура базы данных

Проект использует следующие таблицы:

- users - пользователи системы

- roles - роли пользователей

- permissions - права доступа

* role_permissions - связь многие-ко-многим между ролями и права
* roles - роли пользователей - связь один ко многим с users

После запуска приложения таблицы заполнены тестовыми данными где

мы имеем 4 роли: admin, guest, user, moderator.

По данным из role_permissions, сопоставим каждой роли ее права (permissions) по
кодам.

Роль admin (id: 550e8400-e29b-41d4-a716-446655440000) имеет все 5 прав:

* update_post

* list_product

* create_post

* delete_post

* update_product

Роль guest (id: 550e8400-e29b-41d4-a716-446655440001) имеет только одно право:

* list_product

Роль user (id: 550e8400-e29b-41d4-a716-446655440002) имеет три права:

* update_post

* list_product

* create_post

Роль moderator (id: 550e8400-e29b-41d4-a716-446655440003) имеет четыре права:

* update_post

* list_product

* delete_post

* update_product

# Аутентификация и управление пользователями модуль api_user_services

Регистрация - создание новых пользователей с ролью "guest" по умолчанию

* Эндпоинт для регистрации нового пользователя в системе.

  #### Процесс регестрации:
    - Создает новую учетную запись пользователя
    - Хеширует пароль для безопасного хранения
    - Назначает роль "guest" по умолчанию
    - Активирует учетную запись (is_active=True)
    - Генерирует JWT токен для последующей аутентификации
    - Email должен быть уникальным и валидным
    - Пароль должен должен быть безопасным

* Авторизация - вход в систему с получением JWT токена

  #### Процесс аутентификации:
    - Проверяет валидность email и пароля
    - Верифицирует хеш пароля в базе данных
    - Проверяет активность учетной записи
    - Генерирует JWT токен для доступа к защищенным эндпоинтам
    - Возвращает сообщение об успешной авторизации и jwt токен доступа сроком
      24 часа

* Обновление профиля - изменение данных пользователя

  #### Процесс обновления:
    - Редактировать свой профиль может только авторизованный пользователь
    - Позволяет изменить основные данные профиля
    - Поддерживает частичное обновление (только указанные поля

* Выход из системы - завершение сессии

  #### Процесс выхода:
    - Деактивирует текущую сессию пользователя
    - Не удаляет учетную запись пользователя
    - Пользователь больше не может залогиниться

# Управление правами доступа (Административные функции)

* Просмотр пользователей - получение списка всех пользователей с ролями и
  правами

  ### Требования доступа:
    - Только для администраторов с действительным JWT токеном

  ### Возвращаемые данные:
    - Полный список пользователей системы
    - Детали ролей и прав каждого пользователя

* Изменение ролей - обновление ролей и прав доступа пользователей

  ### Доступ:
    - только администраторы
  ### Вход:
  -email пользователя, новая роль

# Управление контентом

* Просмотр продуктов - получение списка продуктов (требует право list_product)

### Требуемые права:

- **list_product** - право на просмотр списка продуктов

### Группы пользователей с доступом:

- admin
- moderator
- guest
- user

* Удаление поста по ID

### Требуемые права:

- **delete_post** - право на удаления поста

### Группы пользователей с доступом:

- admin
- moderator


* Обновление поста

### Требуемые права:

- **update_post** - право на редактирование поста

### Группы пользователей с доступом:

- admin
- moderator
- user
